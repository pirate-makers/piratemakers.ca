<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Prune">
<meta name="description" content="Updates 1 Thanks to comments by Laurent Demailly, here are some updates. This article have been updated accordinately :
there is now an official Helm Chart for Cert-Manager Istio Ingress also support GRPC, which is based on HTTP/2 Update 2 (2018‚Äì06‚Äì26) I made a new post to use Cert-Manager with Istio 0.8.0 here.
Istio Istio is a part of a new way to manage the flow of data in your Microservice world." />
<meta name="keywords" content="blog,developer,personal,cnc,shapeoko,maker,pirate,hacker,go,golang,devops,gitops, devops, servicemesh, kubernetes" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://piratemakers.ca/posts/2018/01/istio-envoy--cert-manager--lets-encrypt-for-tls/" />


    <title>
        
            Istio (Envoy) &#43; Cert-Manager &#43; Let‚Äôs Encrypt for TLS :: Pirate Makers 
        
    </title>





<link rel="stylesheet" href="https://piratemakers.ca/main.949191c1dcc9c4a887997048b240354e47152016d821198f89448496ba42e491.css" integrity="sha256-lJGRwdzJxKiHmXBIskA1TkcVIBbYIRmPiUSElrpC5JE=">


    
        <link rel="stylesheet" type="text/css" href="https://piratemakers.ca/css/custom.css">
    


    <link rel="apple-touch-icon" sizes="180x180" href="https://piratemakers.ca/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://piratemakers.ca/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://piratemakers.ca/favicon-16x16.png">
    <link rel="manifest" href="https://piratemakers.ca/site.webmanifest">
    <link rel="mask-icon" href="https://piratemakers.ca/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="https://piratemakers.ca/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="Istio (Envoy) &#43; Cert-Manager &#43; Let‚Äôs Encrypt for TLS">
<meta itemprop="description" content="Updates 1 Thanks to comments by Laurent Demailly, here are some updates. This article have been updated accordinately :
there is now an official Helm Chart for Cert-Manager Istio Ingress also support GRPC, which is based on HTTP/2 Update 2 (2018‚Äì06‚Äì26) I made a new post to use Cert-Manager with Istio 0.8.0 here.
Istio Istio is a part of a new way to manage the flow of data in your Microservice world."><meta itemprop="datePublished" content="2018-01-23T23:12:08+00:00" />
<meta itemprop="dateModified" content="2023-12-01T14:31:59-05:00" />
<meta itemprop="wordCount" content="2255"><meta itemprop="image" content="https://piratemakers.ca/images/1.jpeg"><meta itemprop="image" content="https://piratemakers.ca/images/2.jpeg"><meta itemprop="image" content="https://piratemakers.ca/images/3.jpeg">
<meta itemprop="keywords" content="devops,servicemesh,kubernetes," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://piratemakers.ca/images/1.jpeg"/>

<meta name="twitter:title" content="Istio (Envoy) &#43; Cert-Manager &#43; Let‚Äôs Encrypt for TLS"/>
<meta name="twitter:description" content="Updates 1 Thanks to comments by Laurent Demailly, here are some updates. This article have been updated accordinately :
there is now an official Helm Chart for Cert-Manager Istio Ingress also support GRPC, which is based on HTTP/2 Update 2 (2018‚Äì06‚Äì26) I made a new post to use Cert-Manager with Istio 0.8.0 here.
Istio Istio is a part of a new way to manage the flow of data in your Microservice world."/>



    <meta property="og:title" content="Istio (Envoy) &#43; Cert-Manager &#43; Let‚Äôs Encrypt for TLS" />
<meta property="og:description" content="Updates 1 Thanks to comments by Laurent Demailly, here are some updates. This article have been updated accordinately :
there is now an official Helm Chart for Cert-Manager Istio Ingress also support GRPC, which is based on HTTP/2 Update 2 (2018‚Äì06‚Äì26) I made a new post to use Cert-Manager with Istio 0.8.0 here.
Istio Istio is a part of a new way to manage the flow of data in your Microservice world." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://piratemakers.ca/posts/2018/01/istio-envoy--cert-manager--lets-encrypt-for-tls/" /><meta property="og:image" content="https://piratemakers.ca/images/1.jpeg" /><meta property="og:image" content="https://piratemakers.ca/images/2.jpeg" /><meta property="og:image" content="https://piratemakers.ca/images/3.jpeg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-01-23T23:12:08+00:00" />
<meta property="article:modified_time" content="2023-12-01T14:31:59-05:00" />







    <meta property="article:published_time" content="2018-01-23 23:12:08 &#43;0000 UTC" />











    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://piratemakers.ca/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text ">
                Pirate Makers</span>
            <span class="logo__cursor" style=
                  "visibility:hidden;
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://piratemakers.ca/posts/">Blog</a></li><li><a href="https://piratemakers.ca/about/">About</a></li><li><a href="https://piratemakers.ca/tags">Tags</a></li>
        <div class="submenu">
            <li class="dropdown">
                <a href="javascript:void(0)" class="dropbtn">en</a>
                <div class="dropdown-content">
                    
                        
                    
                </div>
            </li>
        </div>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        11 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://piratemakers.ca/posts/2018/01/istio-envoy--cert-manager--lets-encrypt-for-tls/">Istio (Envoy) + Cert-Manager + Let‚Äôs Encrypt for TLS</a>
      </h1>

      

      

      

      <div class="post-content">
        <p><img src="images/1.jpeg#layoutTextWidth" alt="image"></p>
<h4 id="updates-1">Updates 1</h4>
<p>Thanks to comments by Laurent Demailly, here are some updates. This article have been updated accordinately :</p>
<ul>
<li>there is now an <a href="https://github.com/kubernetes/charts/tree/master/stable/cert-manager">official Helm Chart for Cert-Manager</a></li>
<li>Istio Ingress also support GRPC, which is based on HTTP/2</li>
</ul>
<h4 id="update-2-20180626">Update 2 (2018‚Äì06‚Äì26)</h4>
<p>I made a new post to use Cert-Manager with Istio 0.8.0 <a href="https://medium.com/@prune998/istio-0-8-0-envoy-cert-manager-lets-encrypt-for-tls-d26bee634541">here</a>.</p>
<h3 id="istio">Istio</h3>
<p><a href="https://istio.io/">Istio</a> is a part of a new way to manage the flow of data in your Microservice world. In fact, it‚Äôs even more than that to me.<br>
People can‚Äôt stop speaking of Microservice vs Monolith, how it‚Äôs better for dev, easy to maintain, faster to deploy‚Ä¶<br>
Well, they are right, but Microservices is not just having small applications talking to each others. It‚Äôs a way of thinking your infrastructure too. It‚Äôs also how your ‚Äúsimple‚Äù application expose metrics and logs, how you can track the state, how you can control the flow between your services and how you manage errors.</p>
<p>So what can Istio add to this Microservice world ?</p>
<p>Istio is an implementation of a Service Mesh !</p>
<blockquote>
<p>Whaaaaaat ? Service Mesh ? we already have Kubernetes API, we don‚Äôt need a ‚ÄúMesh‚Äù do we ?</p>
</blockquote>
<p>Well, yes you do.<br>
I won‚Äôt explain all the benefits of using it, you‚Äôll find enough docs online. but in few words, a Service Mesh is the layer that gives knowledge of others services to all your services.<br>
In fact, it also enforce all the ‚ÄúMicroservices‚Äù best practices, like adding traffic and error metrics, add support to OpenTracing (Zipkin og Jaegger), allow control of retries, canary deployments, ‚Ä¶ well, read <a href="https://istio.io/docs/concepts/">Istio doc</a> !</p>
<p>So, back to the topic‚Ä¶</p>
<h3 id="prerequisits">Prerequisits</h3>
<ul>
<li>a running Kubernetes Cluster
version 1.7+ recommended</li>
<li>one or many DNS domain names</li>
<li>Istio installed in your cluster with a working Ingress Controler</li>
<li>the DNS domain names from above configured to point to the Istio Ingress IP</li>
</ul>
<h3 id="ssl">SSL</h3>
<p><strong>SSL</strong> is security (well, sort of), but it‚Äôs usually the last thing implemented in software. Why ? Well, it used to be ‚Äúhard‚Äù, but I see no reasons now. [Let‚Äôs Encrypt] (<a href="https://letsencrypt.org/how-it-works/)created">https://letsencrypt.org/how-it-works/)created</a> a new paradigm where it‚Äôs DAMN so easy to create valide SSL certificates using an API call (protocol is called ACME‚Ä¶ ). It offers you 3 ways to validate you‚Äôre the owner of the domain. using DNS, a ‚Äúsecret token‚Äù using HTTP or the, well, the 3rd solution is not available anymore as it proved to be insecure.<br>
So, you set up your DNS with a special TXT record that Let‚Äôs Encrypt gave you, or you put it inside your web root path (like /.well-known/acme-challenge/xxx) and Let‚Äôs Encrypt validate it. This is really simplified, but it‚Äôs almost that.</p>
<p>Some devs decided to implement the ACME protocol directly inside the application. That‚Äôs the decision the guys from <a href="https://traefik.io/">Traefik</a> took. <a href="https://caddyserver.com/">Caddy</a> also did something similar with ‚Äúplugins‚Äù.<br>
It‚Äôs cool because you just have to define your vhost and the application take care of gathering and renewing the certificates.</p>
<p>Sadly, Istio (and the underlying Envoy proxy) did not. And that‚Äôs the point of this blog post !</p>
<h3 id="cert-manager">Cert-Manager</h3>
<p>Many folks got to the idea that, if not every software can implement the ACME protocol, we still need a tool to manage (like request, renew, deprecate) SSL certificates. That‚Äôs why LEGO was created. Then Kube-LEGO for kubernetes, then.. and finaly, they almost all agree to put everything inside <a href="https://github.com/jetstack/cert-manager">Cert-Manager</a> !</p>
<p>Cert-Manager come with a helm chart so it‚Äôs quite easy to deploy‚Ä¶ just follow the doc, but it‚Äôs like :</p>
<p><strong>[update]</strong><br>
There is now an <a href="https://github.com/kubernetes/charts/tree/master/stable/cert-manager">official Helm Chart for Cert-Manager</a>, you don‚Äôt need to <code>git clone</code> , just do the <code>helm install</code> .</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone https://github.com/jetstack/cert-manager
</span></span><span style="display:flex;"><span>cd cert-manager
</span></span><span style="display:flex;"><span><span style="color:#75715e"># check out the latest release tag to ensure we use a supported version of cert-manager</span>
</span></span><span style="display:flex;"><span>git checkout v0.2.3
</span></span><span style="display:flex;"><span>helm install <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --name cert-manager <span style="color:#ae81ff">\ </span> 
</span></span><span style="display:flex;"><span>  --namespace kube-system* <span style="color:#ae81ff">\ </span> 
</span></span><span style="display:flex;"><span>  --set ingressShim.extraArgs<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;{--default-issuer-name=letsencrypt-prod,--default-issuer-kind=ClusterIssuer}&#39;</span> <span style="color:#ae81ff">\ </span> 
</span></span><span style="display:flex;"><span>  contrib/charts/cert-manager
</span></span></code></pre></div><p>This commands will start a Cert-Manager pod in the kube-system Namespace.</p>
<p>I used the configuration line <code>--default-issuer-kind=ClusterIssuer</code> so I can create my issuers only once.</p>
<blockquote>
<p>an Issuer whaaaat ?</p>
</blockquote>
<p>Here‚Äôs how it‚Äôs working :</p>
<ul>
<li>you create an Issuer config which tels the Cert-Manager how to use the ACME API (you will usualy have only 2, staging and prod)</li>
<li>you create a Certificate definition telling which domains need SSL</li>
<li>Cert-Manager request the certificates for you</li>
</ul>
<p>So, let‚Äôs create the issuers. As I‚Äôm creating ClusterIssuers, I don‚Äôt care of a particular Namespace :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">certmanager.k8s.io/v1alpha1  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">ClusterIssuer  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">letsencrypt-prod  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">kube-system  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">acme</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># The ACME server URL  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">server</span>: <span style="color:#ae81ff">https://acme-v01.api.letsencrypt.org/directorr</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Email address used for ACME registration  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">email</span>: <span style="color:#ae81ff">me@domain.com  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Name of a secret used to store the ACME account private key  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">privateKeySecretRef</span>:  
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">letsencrypt-prod  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Enable the HTTP-01 challenge provider  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">http01</span>: {}  
</span></span><span style="display:flex;"><span>---  
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">certmanager.k8s.io/v1alpha1  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">ClusterIssuer  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">letsencrypt-staging  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">kube-system  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">acme</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># The ACME server URL  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">server</span>: <span style="color:#ae81ff">https://acme-staging.api.letsencrypt.org/directory</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Email address used for ACME registration  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">email</span>: <span style="color:#ae81ff">staging+me@domain.com  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Name of a secret used to store the ACME account private key  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">privateKeySecretRef</span>:  
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">letsencrypt-staging  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Enable the HTTP-01 challenge provider  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">http01</span>: {}
</span></span></code></pre></div><p>Then
<code>kubectl apply -f certificate-issuer.yml</code></p>
<p>Now you should have a working Cert-Manager. You need to create the config for your domains/services so the Istio Ingress can pick the right certificate.</p>
<h3 id="istio-ingress">Istio Ingress</h3>
<p>The Ingress is the front Web Proxy where you expose your services. It‚Äôs your edge‚Ä¶ I say WEB PROXY as it only support HTTP/HTTPS for now. But let‚Äôs suppose you know everything about Ingress.</p>
<p><strong>[update]</strong><br>
This is not a real update but a precision, Ingree also support GRPC, which of course is HTTP/2.</p>
<p>The magic of Ingress is it‚Äôs implementation in the Kubernetes API. You create an Ingress Manifest and all your traffic is directed to the right Pod ! Magic ! Told you !</p>
<p>Well, in this case, it‚Äôs Dirty Magic !</p>
<p>For example, the Traefik Ingress binds port 80 and 443, manage the certificates, so you create an ingress for <a href="http://www.mydomain.com">www.mydomain.com</a> and it just works, because it‚Äôs doing everything.</p>
<p>For Istio, as you‚Äôre using the Cert-Manager, there are some more steps. To be quick, here they are (as of 01/2018, it may change quickly) :</p>
<ul>
<li>create a Certificate Request for domain <a href="http://www.mydomain.com">www.mydomain.com</a></li>
<li>Cert-Manager will pick this definition and create a pod, which is in fact a web server that can answer the ACME challenge (<a href="https://github.com/jetstack/cert-manager/blob/master/docs/user-guides/ingress-shim.md">Ingress-Shim</a>)
It will also create a Service and an HTTP Ingress so it is reacheable by the Lets Encrypt servers</li>
<li>The previous point will not work as you are using Istio Ingress, so you have to delete the <code>Service</code> and <code>Ingress</code></li>
<li>Create your own Service that points to the Pod</li>
<li>Create your own Istio Ingress so the pod is accessible</li>
</ul>
<p>Sounds crazy ?<br>
Well, it is, for now. And it‚Äôs EVEN WORSE :</p>
<p>When using Cert-Manager with Istio, you can only have ONE certificate for external services !<br>
So you have to add all the public DNS names to this one certificate !</p>
<p>So let‚Äôs implement it‚Ä¶</p>
<h4 id="certificate">Certificate</h4>
<p>Put this manifest in a file like <em>certificate-istio.yml</em> :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">certmanager.k8s.io/v1alpha1  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Certificate  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">istio-ingress-certs  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">istio-system  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">secretName</span>: <span style="color:#ae81ff">istio-ingress-certs  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">issuerRef</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">letsencrypt-staging  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">kind</span>: <span style="color:#ae81ff">ClusterIssuer  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">commonName</span>: <span style="color:#ae81ff">www.mydomain.com  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">dnsNames</span>:  
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">www.mydomain.com  </span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">mobile.mydomain.com  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">acme</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">config</span>:  
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">http01</span>:  
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">ingressClass</span>: <span style="color:#ae81ff">none  </span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">domains</span>:  
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">www.mydomain.com  </span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">mobile.mydomain.com</span>
</span></span></code></pre></div><p>What we see here is :</p>
<ul>
<li>we want a certificate</li>
<li>it will support 2 domains, <em><a href="https://www.mydomain.com">www.mydomain.com</a></em> and <em>mobile.mydomain.com</em></li>
<li>This Certificate Request is in the same Namespace as the Istio Ingress (istio-system)</li>
<li>it will use the HTTP-01 ACME Challenge</li>
<li>the certificate will be copied to a K8s Secret named <em>istio-ingress-certs ‚Üê</em> this is SUPER IMPORTANT as the Istio Ingress (Envoy proxy) expect it.</li>
</ul>
<p>then :
<code>kubectl apply -f certificate-istio.yml</code></p>
<p>Once done, you will start seeing logs going through the cert-manager pod, as well as in the Istio Ingress‚Ä¶ something like :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>istio-ingress-7f8468bb7b-pxl94 istio-ingress [2018-01-23T21:01:53.341Z] &#34;GET /.well-known/acme-challenge/xxxxxxx HTTP/1.1&#34; 503 UH 0 19 0 - &#34;10.20.5.1&#34; &#34;Go-http-client/1.1&#34; &#34;xxx&#34; &#34;www.domain.com&#34; &#34;-&#34;  
</span></span><span style="display:flex;"><span>istio-ingress-7f8468bb7b-pxl94 istio-ingress [2018-01-23T21:01:58.287Z] &#34;GET /.well-known/acme-challenge/xxxxxx HTTP/1.1&#34; 503 UH 0 19 0 - &#34;10.20.5.1&#34; &#34;Go-http-client/1.1&#34; &#34;xxxx&#34; &#34;mobile.domain.com&#34; &#34;-&#34;
</span></span></code></pre></div><p>This is because the Let‚Äôs Encrypt servers is polling for the validation token and your setup is not working yet. As of now your setup looks like that :</p>
<p><img src="images/2.jpeg#layoutTextWidth" alt="image"></p>
<p>Now it‚Äôs time to remove the unwanted stuff created by Cert-Manager.<br>
Use your best K8s tool, like the Dashboard or kubectl, and remove the service and ingress from the <em>istio-system</em> Namespace. They will be named like <strong>cm-istio-ingress-certs-xxxx.</strong> If you have many domain names in your certificate request, you will have more things to remove.</p>
<p>Also, don‚Äôt remove the pods !! (they will be re-created in case of error)</p>
<p>(as a reminder : kubectl -n istio-system delete ing cm-istio-ingress-certs-xxxx)</p>
<h4 id="services">Services</h4>
<p>Now that your setup is clean, you can go on and re-create the needed Services and Ingress.</p>
<p>You will need as many services as you have different domain names. In our case, 2. Here is the manifest :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Service  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">cert-manager-ingress-www  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">istio-system  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">annotations</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">auth.istio.io/8089</span>: <span style="color:#ae81ff">NONE  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ports</span>:  
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">port</span>: <span style="color:#ae81ff">8089</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">http-certingr  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">certmanager.k8s.io/domain</span>: <span style="color:#ae81ff">www.mydomain.com  </span>
</span></span><span style="display:flex;"><span>---  
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Service  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">cert-manager-ingress-mobile  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">istio-system  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">annotations</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">auth.istio.io/8089</span>: <span style="color:#ae81ff">NONE  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ports</span>:  
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">port</span>: <span style="color:#ae81ff">8089</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">http-certingr  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">certmanager.k8s.io/domain</span>: <span style="color:#ae81ff">mobile.mydomain.com</span>
</span></span></code></pre></div><p>then
<code>kubectl apply -f certificate-services.yml</code></p>
<p>You can then check your services. Each one should have one taget pod assigned.</p>
<p>Note here that the Service Name does not matter. It‚Äôs up to you to give a specific name so you will not mix up all your domains.</p>
<h4 id="ingress">Ingress</h4>
<p>It‚Äôs now time to create the Ingress so your ‚ÄúACME Token Pods‚Äù are accessible from the outside.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">extensions/v1beta1  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Ingress  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">annotations</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">kubernetes.io/ingress.class</span>: <span style="color:#ae81ff">istio  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">certmanager.k8s.io/acme-challenge-type</span>: <span style="color:#ae81ff">http01  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">certmanager.k8s.io/cluster-issuer</span>: <span style="color:#ae81ff">letsencrypt-staging  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">istio-ingress-certs-mgr  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">istio-system  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">rules</span>:  
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">http</span>:  
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">paths</span>:  
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/.well-known/acme-challenge/.*  </span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">backend</span>:  
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">serviceName</span>: <span style="color:#ae81ff">cert-manager-ingress-www  </span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">servicePort</span>: <span style="color:#ae81ff">http-certingr  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">host</span>: <span style="color:#ae81ff">www.mydomain.com  </span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">http</span>:  
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">paths</span>:  
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/.well-known/acme-challenge/.*  </span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">backend</span>:  
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">serviceName</span>: <span style="color:#ae81ff">cert-manager-ingress-mobile  </span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">servicePort</span>: <span style="color:#ae81ff">http-certingr  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">host</span>: <span style="color:#ae81ff">mobile.mydomain.com</span>
</span></span></code></pre></div><p>Again, we have a few things to note here :</p>
<ul>
<li>ingress is in the same Namespace as the Certificate, Services and Ingress</li>
<li>ingress Class is <em>Istio</em> (obviously)</li>
<li>we are using the <em>staging</em> issuer (remember the first step when we created the Issuers)
Depending wether you created an <code>Issuer</code> or a <code>ClusterIssuer</code> your have to use the right annotation. Documentation is in the <a href="https://github.com/jetstack/cert-manager/blob/master/docs/user-guides/ingress-shim.md">Ingress-Shim</a> project</li>
<li>we must create an HTTP rule for each domain</li>
<li>the <em>backend/serviceName</em> must match the services we created in the previous step, as well as the domain name, so :
<em><a href="https://www.mydomain.com">www.mydomain.com</a></em> ‚Üí serviceName <em>cert-manager-ingress-www</em> ‚Üí pod <em>cm-istio-ingress-certs-xxx</em> where the label <em>certmanager.k8s.io/domain =</em> <a href="http://www.mydomain.com"><em>www.mydomain.com</em></a></li>
</ul>
<p>again :
<code>kubectl apply -f certificate-ingress.yml</code></p>
<p>And that‚Äôs it !</p>
<p>Checking the Istio-Ingress logs, you should see a couple of <em>‚ÄúGET /.well-known/acme-challenge/xxx HTTP/1.1‚Äù 200</em></p>
<h3 id="sample-application">Sample application</h3>
<p>I used a sample application to validate my setup is working:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Service  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">helloworld-v1  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">labels</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">app</span>: <span style="color:#ae81ff">helloworld  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">version</span>: <span style="color:#ae81ff">v1  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ports</span>:  
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">http  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">port</span>: <span style="color:#ae81ff">8080</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">app</span>: <span style="color:#ae81ff">helloworld  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">version</span>: <span style="color:#ae81ff">v1  </span>
</span></span><span style="display:flex;"><span>---  
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Service  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">helloworld-v2  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">labels</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">app</span>: <span style="color:#ae81ff">helloworld  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">version</span>: <span style="color:#ae81ff">v2  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ports</span>:  
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">http  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">port</span>: <span style="color:#ae81ff">8080</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">app</span>: <span style="color:#ae81ff">helloworld  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">version</span>: <span style="color:#ae81ff">v2  </span>
</span></span><span style="display:flex;"><span>---  
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">extensions/v1beta1  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Ingress  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">annotations</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">kubernetes.io/ingress.class</span>: <span style="color:#ae81ff">istio  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">kubernetes.io/ingress.allow-http</span>: <span style="color:#e6db74">&#34;false&#34;</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">istio-ingress-https  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">tls</span>:  
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">secretName</span>: <span style="color:#ae81ff">istio-ingress-certs  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">rules</span>:  
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">http</span>:  
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">paths</span>:  
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/.*  </span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">backend</span>:  
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">serviceName</span>: <span style="color:#ae81ff">helloworld-v1  </span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">servicePort</span>: <span style="color:#ae81ff">8080</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">host</span>: <span style="color:#ae81ff">www.mydomain.com</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">http</span>:  
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">paths</span>:  
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/.*  </span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">backend</span>:  
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">serviceName</span>: <span style="color:#ae81ff">helloworld-v2  </span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">servicePort</span>: <span style="color:#ae81ff">8080</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">host</span>: <span style="color:#ae81ff">mobile.mydomain.com  </span>
</span></span><span style="display:flex;"><span>---  
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">extensions/v1beta1  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Ingress  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">annotations</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">kubernetes.io/ingress.class</span>: <span style="color:#ae81ff">istio  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">istio-ingress-http  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">rules</span>:  
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">http</span>:  
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">paths</span>:  
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/.*  </span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">backend</span>:  
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">serviceName</span>: <span style="color:#ae81ff">helloworld-v1  </span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">servicePort</span>: <span style="color:#ae81ff">8080</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">host</span>: <span style="color:#ae81ff">www.mydomain.com</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">http</span>:  
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">paths</span>:  
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/.*  </span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">backend</span>:  
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">serviceName</span>: <span style="color:#ae81ff">helloworld-v2  </span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">servicePort</span>: <span style="color:#ae81ff">8080</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">host</span>: <span style="color:#ae81ff">mobile.mydomain.com  </span>
</span></span><span style="display:flex;"><span>---  
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">ReplicationController  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">labels</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">app</span>: <span style="color:#ae81ff">helloworld  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">version</span>: <span style="color:#ae81ff">v1  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">helloworld-v1  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">replicas</span>: <span style="color:#ae81ff">1</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">template</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">metadata</span>:  
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">labels</span>:  
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">app</span>: <span style="color:#ae81ff">helloworld  </span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">version</span>: <span style="color:#ae81ff">v1  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">spec</span>:  
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">containers</span>:  
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">image</span>: <span style="color:#e6db74">&#34;kelseyhightower/helloworld:v1&#34;</span>  
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">name</span>: <span style="color:#ae81ff">helloworld  </span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">ports</span>:  
</span></span><span style="display:flex;"><span>            - <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">8080</span>  
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">name</span>: <span style="color:#ae81ff">http  </span>
</span></span><span style="display:flex;"><span>---  
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">ReplicationController  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">labels</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">app</span>: <span style="color:#ae81ff">helloworld  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">version</span>: <span style="color:#ae81ff">v2  </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">helloworld-v2  </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">replicas</span>: <span style="color:#ae81ff">1</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">template</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">metadata</span>:  
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">labels</span>:  
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">app</span>: <span style="color:#ae81ff">helloworld  </span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">version</span>: <span style="color:#ae81ff">v2  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">spec</span>:  
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">containers</span>:  
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">image</span>: <span style="color:#e6db74">&#34;kelseyhightower/helloworld:v2&#34;</span>  
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">name</span>: <span style="color:#ae81ff">helloworld  </span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">ports</span>:  
</span></span><span style="display:flex;"><span>            - <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">8080</span>  
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">name</span>: <span style="color:#ae81ff">http</span>
</span></span></code></pre></div><p>We must thanks Kelsy Hightower, again, for his HelloWorld example app üôè</p>
<p>then:
<code>kubectl -n default apply -f helloworld.yml</code></p>
<p>Note you will need one Ingress for all you HTTPS domains, and one for the HTTP‚Ä¶ Only the HTTPS is represented here :</p>
<p><img src="images/3.jpeg#layoutTextWidth" alt="image"></p>
<p>Cert-Manager should remove the Token-Exchange pods in the istio-system namespace after the validation is done. Yes, once the Cert-Manager agreed with the Let‚Äôs Encrypt servers, they exchange a permanent key that is used for renewal. No need of the pods, and even Services and Ingress, at least if your are sure you will not need to add or change something in the certificate.</p>
<h3 id="updating-the-certificate">Updating the Certificate</h3>
<p>When updating the certificate, I suggest to first create the right <code>Service</code> for it. Then update the <code>Ingress</code> to send traffic to the right service.<br>
Finally, update your <code>Certificate</code> definition and add the new domain name.</p>
<p>Cert-Manager will create a new <code>ingress</code> and <code>service</code> that you will have to delete. Everything else will take place by itself. Wait a few seconds for <code>Istio-Ingress</code> to reload it‚Äôs certificate and you‚Äôre good to <code>curl</code> !</p>
<h3 id="conclusion">Conclusion</h3>
<p>While I find it pretty ugly right now, it‚Äôs working‚Ä¶<br>
If you need to update your certificate or add a new domain name, you will have to update your certificate definition so the whole process can start over. This is really a pain and certainly a LOT harder than having it fully integrated like with Traefik or Caddy. I‚Äôm sure this will change quickly though.</p>
<p>I would like to thank <a href="https://github.com/ldemailly">Laurent Demailly</a> for it‚Äôs work on this. See Istio Issue [868] (<a href="https://github.com/istio/istio.github.io/issues/868)for">https://github.com/istio/istio.github.io/issues/868)for</a> more details and discussion. He‚Äôs working on a sample application deployment, Fortio, using Istio + TLS and he‚Äôs the one who inspired and help me getting all this to work.</p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://piratemakers.ca/tags/devops/">devops</a></span>
        <span class="tag"><a href="https://piratemakers.ca/tags/servicemesh/">servicemesh</a></span>
        <span class="tag"><a href="https://piratemakers.ca/tags/kubernetes/">kubernetes</a></span>
        
    </p>

      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        2255 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2018-01-23 18:12
        

         
          
            
              (Last updated: 2023-12-01 14:31)
            
          
        
      </p>
        <p>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit">
            <circle cx="12" cy="12" r="4"></circle>
            <line x1="1.05" y1="12" x2="7" y2="12"></line>
            <line x1="17.01" y1="12" x2="22.96" y2="12"></line>
          </svg>

          <a href="1ab993c2d9f5b7b58edda6893280e093b620e8db" target="_blank" rel="noopener">1ab993c</a>
          @ 2023-12-01
        </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fpiratemakers.ca%2fposts%2f2018%2f01%2fistio-envoy--cert-manager--lets-encrypt-for-tls%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fpiratemakers.ca%2fposts%2f2018%2f01%2fistio-envoy--cert-manager--lets-encrypt-for-tls%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=Istio%20%28Envoy%29%20%2b%20Cert-Manager%20%2b%20Let%e2%80%99s%20Encrypt%20for%20TLS&amp;caption=Istio%20%28Envoy%29%20%2b%20Cert-Manager%20%2b%20Let%e2%80%99s%20Encrypt%20for%20TLS&amp;canonicalUrl=https%3a%2f%2fpiratemakers.ca%2fposts%2f2018%2f01%2fistio-envoy--cert-manager--lets-encrypt-for-tls%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=Istio%20%28Envoy%29%20%2b%20Cert-Manager%20%2b%20Let%e2%80%99s%20Encrypt%20for%20TLS&amp;body=https%3a%2f%2fpiratemakers.ca%2fposts%2f2018%2f01%2fistio-envoy--cert-manager--lets-encrypt-for-tls%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fpiratemakers.ca%2fposts%2f2018%2f01%2fistio-envoy--cert-manager--lets-encrypt-for-tls%2f&amp;media=https%3a%2f%2fpiratemakers.ca%2fposts%2f2018%2f01%2fistio-envoy--cert-manager--lets-encrypt-for-tls%2f;description=Istio%20%28Envoy%29%20%2b%20Cert-Manager%20%2b%20Let%e2%80%99s%20Encrypt%20for%20TLS" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fpiratemakers.ca%2fposts%2f2018%2f01%2fistio-envoy--cert-manager--lets-encrypt-for-tls%2f&amp;title=Istio%20%28Envoy%29%20%2b%20Cert-Manager%20%2b%20Let%e2%80%99s%20Encrypt%20for%20TLS&amp;summary=Istio%20%28Envoy%29%20%2b%20Cert-Manager%20%2b%20Let%e2%80%99s%20Encrypt%20for%20TLS&amp;source=https%3a%2f%2fpiratemakers.ca%2fposts%2f2018%2f01%2fistio-envoy--cert-manager--lets-encrypt-for-tls%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2fpiratemakers.ca%2fposts%2f2018%2f01%2fistio-envoy--cert-manager--lets-encrypt-for-tls%2f&amp;resubmit=true&amp;title=Istio%20%28Envoy%29%20%2b%20Cert-Manager%20%2b%20Let%e2%80%99s%20Encrypt%20for%20TLS" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2fpiratemakers.ca%2fposts%2f2018%2f01%2fistio-envoy--cert-manager--lets-encrypt-for-tls%2f;title=Istio%20%28Envoy%29%20%2b%20Cert-Manager%20%2b%20Let%e2%80%99s%20Encrypt%20for%20TLS" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=Istio%20%28Envoy%29%20%2b%20Cert-Manager%20%2b%20Let%e2%80%99s%20Encrypt%20for%20TLS%20https%3a%2f%2fpiratemakers.ca%2fposts%2f2018%2f01%2fistio-envoy--cert-manager--lets-encrypt-for-tls%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fpiratemakers.ca%2fposts%2f2018%2f01%2fistio-envoy--cert-manager--lets-encrypt-for-tls%2f&amp;t=Istio%20%28Envoy%29%20%2b%20Cert-Manager%20%2b%20Let%e2%80%99s%20Encrypt%20for%20TLS" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=Istio%20%28Envoy%29%20%2b%20Cert-Manager%20%2b%20Let%e2%80%99s%20Encrypt%20for%20TLS&amp;url=https%3a%2f%2fpiratemakers.ca%2fposts%2f2018%2f01%2fistio-envoy--cert-manager--lets-encrypt-for-tls%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>

    
    <div class="pagination">
        

        <div class="pagination__buttons">
            
            <span class="button previous">
                <a href="https://piratemakers.ca/posts/2018/06/istio-0.8.0-envoy--cert-manager--lets-encrypt-for-tls/">
                    <span class="button__icon">‚Üê</span>
                    <span class="button__text">Istio 0.8.0 (Envoy) &#43; Cert-Manager &#43; Let‚Äôs Encrypt for TLS</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="https://piratemakers.ca/posts/2017/07/what-nobody-tells-you-about-kubernetes/">
                    <span class="button__text">What nobody tells you about Kubernetes</span>
                    <span class="button__icon">‚Üí</span>
                </a>
            </span>
            
        </div>
    </div>


    
      
        <div id="comments">
          <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "piratemakers-ca" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
      
    

    

    

  </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2023</span>
            
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span><a href="https://piratemakers.ca/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            <span>Pirate Makers‚Ñ¢</span>
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="https://piratemakers.ca/bundle.min.0931a358499291afca6f741478e9fc9fa973a9fbd7aeb3390f3b10463966dc8195daf98a0e33685a1fbfb9d7578631c3f31fc8e558eaf6e2c30c4c3e14df4931.js" integrity="sha512-CTGjWEmSka/Kb3QUeOn8n6lzqfvXrrM5DzsQRjlm3IGV2vmKDjNoWh&#43;/uddXhjHD8x/I5Vjq9uLDDEw&#43;FN9JMQ=="></script>




    </body>
</html>
